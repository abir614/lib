.key-verification-modal{position:fixed;top:0;left:0;width:100%;height:100%;z-index:10000;display:flex;align-items:center;justify-content:center;animation:fadeIn 0.3s ease;}.verification-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgb(0 0 0 / 0.7);backdrop-filter:blur(5px);}.verification-content{position:relative;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border-radius:20px;box-shadow:0 20px 60px rgb(0 0 0 / 0.3);max-width:550px;width:90%;max-height:85vh;overflow-y:auto;animation:slideUp 0.3s ease;}.verification-content.user-list-modal{max-width:650px;}.verification-header{padding:25px 30px;border-bottom:1px solid rgb(255 255 255 / 0.2);display:flex;justify-content:space-between;align-items:center;}.verification-header h3{color:#fff;margin:0;font-size:1.4em;display:flex;align-items:center;gap:12px;}.verification-header i{font-size:1.2em;}.close-btn{background:rgb(255 255 255 / 0.2);border:none;color:#fff;width:36px;height:36px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.3s ease;}.close-btn:hover{background:rgb(255 255 255 / 0.3);transform:rotate(90deg);}.verification-body{padding:30px;color:#fff;}.security-score-banner{background:rgb(0 0 0 / 0.3);border-radius:12px;padding:20px;margin-bottom:25px;display:flex;align-items:center;gap:20px;}.score-circle{width:80px;height:80px;border-radius:50%;display:flex;flex-direction:column;align-items:center;justify-content:center;border:4px solid;flex-shrink:0;}.score-circle.perfect{border-color:#10b981;background:rgb(16 185 129 / 0.2);}.score-circle.good{border-color:#3b82f6;background:rgb(59 130 246 / 0.2);}.score-circle.warning{border-color:#f59e0b;background:rgb(245 158 11 / 0.2);}.score-number{font-size:1.5em;font-weight:700;color:#fff;}.score-label{font-size:0.75em;opacity:0.9;color:#fff;}.score-details{flex:1;display:flex;flex-direction:column;gap:8px;}.score-item{display:flex;align-items:center;gap:10px;font-size:0.95em;color:#fff;}.score-item span{color:#fff;font-weight:500;}.score-item i{font-size:1.1em;}.verification-status{display:flex;align-items:center;gap:12px;padding:15px;border-radius:12px;margin:20px 0;font-weight:600;font-size:1.05em;}.verification-status.verified{background:rgb(16 185 129 / 0.2);border:2px solid #10b981;color:#10b981;}.verification-status.auto-accepted{background:rgb(59 130 246 / 0.2);border:2px solid #3b82f6;color:#60a5fa;}.verification-status.unverified{background:rgb(245 158 11 / 0.2);border:2px solid #f59e0b;color:#fbbf24;}.verification-status i{font-size:1.4em;}.verification-info{margin-bottom:20px;line-height:1.6;}.verification-info p{margin:0;opacity:0.95;}.verification-info.success{background:rgb(16 185 129 / 0.15);border-left:4px solid #10b981;padding:15px;border-radius:8px;display:flex;gap:12px;align-items:start;}.verification-info.success i{color:#10b981;font-size:1.2em;margin-top:2px;flex-shrink:0;}.verification-info.info{background:rgb(59 130 246 / 0.15);border-left:4px solid #3b82f6;padding:15px;border-radius:8px;display:flex;gap:12px;align-items:start;}.verification-info.info i{color:#60a5fa;font-size:1.2em;margin-top:2px;flex-shrink:0;}.verification-info.warning{background:rgb(245 158 11 / 0.15);border-left:4px solid #f59e0b;padding:15px;border-radius:8px;display:flex;gap:12px;align-items:start;}.verification-info.warning i{color:#fbbf24;font-size:1.2em;margin-top:2px;flex-shrink:0;}.fingerprint-section{margin:20px 0;}.fingerprint-section label{display:block;font-size:0.9em;opacity:0.9;margin-bottom:10px;font-weight:600;}.fingerprint-display{background:rgb(0 0 0 / 0.4);padding:20px;border-radius:12px;position:relative;border:1px solid rgb(255 255 255 / 0.1);}.fingerprint-display.short{background:rgb(0 0 0 / 0.3);}.fingerprint-display code{display:block;color:#4ade80;font-family:"SF Mono","Monaco","Inconsolata","Fira Code","Courier New",monospace;font-size:0.95em;line-height:1.8;word-break:break-all;margin-bottom:15px;text-shadow:0 0 10px rgb(74 222 128 / 0.3);}.copy-btn{background:rgb(255 255 255 / 0.2);border:1px solid rgb(255 255 255 / 0.3);color:#fff;padding:8px 16px;border-radius:8px;cursor:pointer;font-size:0.9em;display:inline-flex;align-items:center;gap:8px;transition:all 0.3s ease;margin-right:10px;}.copy-btn:hover{background:rgb(255 255 255 / 0.3);transform:translateY(-2px);}.verification-explainer{background:rgb(255 255 255 / 0.1);padding:20px;border-radius:12px;margin:20px 0;}.verification-explainer h4{margin:0 0 15px 0;display:flex;align-items:center;gap:10px;font-size:1.1em;}.verification-explainer ul{margin:0;padding-left:20px;}.verification-explainer li{margin-bottom:10px;line-height:1.5;}.verification-explainer li strong{color:#4ade80;}.method-item{display:flex;align-items:start;gap:15px;padding:12px;background:rgb(0 0 0 / 0.2);border-radius:8px;position:relative;}.method-item i{font-size:1.5em;color:#60a5fa;flex-shrink:0;margin-top:4px;}.method-item > div{flex:1;}.method-item strong{display:block;margin-bottom:4px;}.method-item p{margin:0;font-size:0.9em;opacity:0.9;}.method-action-btn{background:rgb(59 130 246 / 0.3);border:1px solid #3b82f6;color:#fff;width:40px;height:40px;border-radius:8px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.3s ease;flex-shrink:0;}.method-action-btn:hover{background:rgb(59 130 246 / 0.5);transform:scale(1.05);}.method-action-btn i{font-size:1.2em;color:#fff;margin:0;}.verification-methods{background:rgb(255 255 255 / 0.1);padding:20px;border-radius:12px;margin:20px 0;}.verification-methods h4{margin:0 0 15px 0;display:flex;align-items:center;gap:10px;font-size:1.1em;}.method-list{display:flex;flex-direction:column;gap:12px;}.qr-code-container{display:flex;justify-content:center;align-items:center;padding:30px;background:#fff;border-radius:12px;margin:20px 0;}#qr-code-display{display:flex;justify-content:center;align-items:center;}#qr-code-display canvas,#qr-code-display img{max-width:100%;height:auto;border-radius:8px;}.qr-scanner-container{position:relative;width:100%;max-width:400px;margin:20px auto;background:#000;border-radius:12px;overflow:hidden;aspect-ratio:1;}#qr-video{width:100%;height:100%;object-fit:cover;}.scanner-overlay{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;pointer-events:none;}.scanner-frame{width:250px;height:250px;border:3px solid #4ade80;border-radius:12px;box-shadow:0 0 0 9999px rgb(0 0 0 / 0.5),0 0 20px rgb(74 222 128 / 0.5),inset 0 0 20px rgb(74 222 128 / 0.3);animation:scannerPulse 2s ease-in-out infinite;position:relative;}.scanner-frame::before,.scanner-frame::after{content:"";position:absolute;width:20px;height:20px;border:3px solid #4ade80;}.scanner-frame::before{top:-3px;left:-3px;border-right:none;border-bottom:none;}.scanner-frame::after{bottom:-3px;right:-3px;border-left:none;border-top:none;}@keyframes scannerPulse{0%,100%{box-shadow:0 0 0 9999px rgb(0 0 0 / 0.5),0 0 20px rgb(74 222 128 / 0.5),inset 0 0 20px rgb(74 222 128 / 0.3);}50%{box-shadow:0 0 0 9999px rgb(0 0 0 / 0.5),0 0 30px rgb(74 222 128 / 0.8),inset 0 0 30px rgb(74 222 128 / 0.5);}}.scan-result{margin-top:20px;}.scan-result .verification-info{animation:slideIn 0.3s ease;}.scanner-status{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,0.8);color:#4ade80;padding:10px 20px;border-radius:20px;font-size:0.9em;font-weight:600;z-index:10;white-space:nowrap;backdrop-filter:blur(10px);border:1px solid rgba(74,222,128,0.3);}@keyframes slideIn{from{opacity:0;transform:translateY(-10px);}to{opacity:1;transform:translateY(0);}}.key-status-banner{background:rgb(0 0 0 / 0.3);border-radius:12px;padding:15px 20px;margin-bottom:20px;display:flex;align-items:center;gap:15px;border:2px solid;}.key-status-banner.success{border-color:#10b981;background:rgb(16 185 129 / 0.15);}.key-status-banner.warning{border-color:#f59e0b;background:rgb(245 158 11 / 0.15);}.key-status-banner i{font-size:1.5em;flex-shrink:0;}.key-status-banner.success i{color:#10b981;}.key-status-banner.warning i{color:#fbbf24;}.key-status-banner > div{flex:1;}.key-status-banner strong{display:block;margin-bottom:4px;}.key-status-banner p{margin:0;font-size:0.9em;opacity:0.9;}.key-security-info{background:rgb(59 130 246 / 0.15);border-left:4px solid #3b82f6;padding:15px;border-radius:8px;display:flex;gap:12px;align-items:center;margin:20px 0;}.key-security-info i{color:#60a5fa;font-size:1.2em;flex-shrink:0;}.key-security-info div{line-height:1.5;}.key-security-info strong{display:block;margin-bottom:4px;}.key-actions-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:20px;}@media(max-width:600px){.key-actions-grid{grid-template-columns:1fr;}}.action-card{background:rgb(255 255 255 / 0.1);border:1px solid rgb(255 255 255 / 0.2);padding:15px;border-radius:12px;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:8px;color:#fff;transition:all 0.3s ease;}.action-card:hover{background:rgb(255 255 255 / 0.2);transform:translateY(-3px);}.action-card i{font-size:1.5em;}.action-card span{font-size:0.9em;font-weight:600;}.verification-footer{padding:20px 30px;border-top:1px solid rgb(255 255 255 / 0.2);display:flex;gap:12px;justify-content:flex-end;flex-wrap:wrap;}.btn-verify,.btn-unverify,.btn-primary,.btn-auto-accept{background:#fff;color:#667eea;border:none;padding:12px 24px;border-radius:10px;font-weight:600;cursor:pointer;display:inline-flex;align-items:center;gap:8px;transition:all 0.3s ease;white-space:nowrap;}.btn-verify:hover,.btn-primary:hover,.btn-auto-accept:hover{background:#f0f0f0;transform:translateY(-2px);box-shadow:0 5px 15px rgb(0 0 0 / 0.2);}.btn-auto-accept{background:#3b82f6;color:#fff;}.btn-auto-accept:hover{background:#2563eb;}.btn-auto-accept-all{background:#3b82f6;color:#fff;border:none;padding:12px 24px;border-radius:10px;font-weight:600;cursor:pointer;display:inline-flex;align-items:center;gap:8px;transition:all 0.3s ease;}.btn-auto-accept-all:hover{background:#2563eb;transform:translateY(-2px);box-shadow:0 5px 15px rgb(59 130 246 / 0.3);}.btn-unverify{background:#ef4444;color:#fff;}.btn-unverify:hover{background:#dc2626;transform:translateY(-2px);box-shadow:0 5px 15px rgb(239 68 68 / 0.3);}.btn-secondary{background:rgb(255 255 255 / 0.2);border:1px solid rgb(255 255 255 / 0.3);color:#fff;padding:12px 24px;border-radius:10px;font-weight:600;cursor:pointer;transition:all 0.3s ease;}.btn-secondary:hover{background:rgb(255 255 255 / 0.3);transform:translateY(-2px);}.user-list-item{background:rgb(255 255 255 / 0.1);padding:15px;border-radius:12px;margin-bottom:12px;display:flex;justify-content:space-between;align-items:center;gap:15px;transition:all 0.3s ease;border-left:4px solid #fff0;}.user-list-item:hover{background:rgb(255 255 255 / 0.15);transform:translateX(5px);}.user-list-item.verified{border-left-color:#10b981;}.user-list-item.auto-accepted{border-left-color:#3b82f6;}.user-list-item.unverified{border-left-color:#f59e0b;}.user-info{flex:1;min-width:0;}.user-name{display:flex;align-items:center;gap:10px;margin-bottom:8px;font-size:1.1em;}.user-name i{flex-shrink:0;}.user-name strong{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}.user-fingerprint{margin-top:6px;}.user-fingerprint code{color:#a5b4fc;font-size:0.85em;opacity:0.9;font-family:"SF Mono","Monaco",monospace;}.user-actions{display:flex;align-items:center;gap:12px;flex-shrink:0;}.verification-badge{padding:6px 12px;border-radius:20px;font-size:0.85em;font-weight:600;display:inline-flex;align-items:center;gap:6px;background:rgb(255 255 255 / 0.2);color:#fff;white-space:nowrap;}.verification-badge.verified{background:rgb(16 185 129 / 0.3);color:#4ade80;}.verification-badge.auto-accepted{background:rgb(59 130 246 / 0.3);color:#60a5fa;}.verification-badge.unverified{background:rgb(245 158 11 / 0.3);color:#fbbf24;}.btn-small{background:rgb(255 255 255 / 0.2);border:1px solid rgb(255 255 255 / 0.3);color:#fff;padding:8px 14px;border-radius:8px;cursor:pointer;font-size:0.9em;display:inline-flex;align-items:center;gap:6px;transition:all 0.3s ease;white-space:nowrap;}.btn-small:hover{background:rgb(255 255 255 / 0.3);transform:translateY(-2px);}.btn-small.disabled{opacity:0.5;cursor:not-allowed;}.btn-small.disabled:hover{background:rgb(255 255 255 / 0.2);transform:none;}.empty-state{text-align:center;padding:40px 20px;opacity:0.7;}.empty-state i{font-size:3em;margin-bottom:15px;opacity:0.5;}.empty-state p{margin:0;font-size:1.1em;}.decryption-error-badge{background:rgb(239 68 68 / 0.2);border:1px solid #ef4444;border-radius:8px;padding:10px;margin-top:10px;display:flex;align-items:center;gap:10px;font-size:0.9em;color:#ef4444;}.decryption-error-badge i{font-size:1.1em;}.retry-btn{background:#ef4444;color:#fff;border:none;padding:6px 12px;border-radius:6px;cursor:pointer;font-size:0.9em;display:inline-flex;align-items:center;gap:6px;margin-left:auto;transition:all 0.3s ease;}.retry-btn:hover{background:#dc2626;transform:scale(1.05);}#verify-keys-btn{position:relative;margin-right:1rem;}#verify-keys-btn::after{content:"";position:absolute;top:-2px;right:-2px;width:8px;height:8px;background:#10b981;border-radius:50%;border:2px solid #fff;opacity:0;transition:opacity 0.3s ease;}#verify-keys-btn.has-unverified::after{opacity:1;background:#fbbf24;}@keyframes fadeIn{from{opacity:0;}to{opacity:1;}}@keyframes slideUp{from{opacity:0;transform:translateY(30px);}to{opacity:1;transform:translateY(0);}}@media(max-width:768px){.security-score-banner{flex-direction:column;text-align:center;}.score-details{width:100%;}.key-actions-grid{grid-template-columns:1fr;}.qr-scanner-container{max-width:300px;}.scanner-frame{width:200px;height:200px;}}@media(max-width:600px){.verification-content{max-width:95%;border-radius:15px;max-height:90vh;}.verification-header{padding:20px;}.verification-header h3{font-size:1.2em;}.verification-body{padding:20px;}.fingerprint-display code{font-size:0.8em;line-height:1.6;}.user-list-item{flex-direction:column;align-items:flex-start;gap:12px;}.user-actions{width:100%;justify-content:space-between;}.verification-footer{flex-direction:column;gap:10px;}.btn-verify,.btn-unverify,.btn-primary,.btn-secondary,.btn-auto-accept,.btn-auto-accept-all{width:100%;justify-content:center;}.method-list{gap:10px;}.method-item{padding:10px;}.score-item{font-size:0.85em;}}.verification-content::-webkit-scrollbar{width:8px;}.verification-content::-webkit-scrollbar-track{background:rgb(255 255 255 / 0.1);border-radius:10px;}.verification-content::-webkit-scrollbar-thumb{background:rgb(255 255 255 / 0.3);border-radius:10px;}.verification-content::-webkit-scrollbar-thumb:hover{background:rgb(255 255 255 / 0.4);}@media(prefers-color-scheme:dark){.verification-content{background:linear-gradient(135deg,#1e293b 0%,#334155 100%);}}@media print{.key-verification-modal{display:none;}}
