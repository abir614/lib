const UIManager={elements:{},init(){this.elements={loginContainer:document.querySelector('.login-container'),usernameInput:document.getElementById('username'),roomIdInput:document.getElementById('roomId'),joinButton:document.getElementById('join'),statusDot:document.querySelector('.connection-status .status-dot'),statusText:document.querySelector('.connection-status .status-text'),chatContainer:document.getElementById('chat-container'),messagesContainer:document.getElementById('messages'),messageInput:document.getElementById('message'),sendButton:document.getElementById('send'),backButton:document.getElementById('back-button'),downloadButton:document.getElementById('download-history-button'),roomDisplay:document.getElementById('room-display'),activeUsers:document.getElementById('active-users'),imageUpload:document.getElementById('imageUpload'),charCount:document.getElementById('char-count'),typingIndicator:document.getElementById('typing-indicator'),loadingIndicator:document.getElementById('loading-indicator')};return this.elements},showNotification(e,t="info"){const o=document.createElement("div");o.className=`notification ${t}`;const n=e.replace(/\*\*(.*?)\*\*/g,'<b><i>$1</i></b>');o.innerHTML=n,o.style.cssText=`position: fixed;top: 20px;right: 20px;padding: 15px 20px;background: ${t==="error"?"#dc3545":"#28a745"};color: white;border-radius: 5px;z-index: 10000;animation: slideIn 0.3s ease;box-shadow: 0 4px 12px rgba(0,0,0,0.2);`,document.body.appendChild(o),setTimeout(()=>{o.style.animation="slideOut 0.3s ease",setTimeout(()=>o.remove(),300)},3e3)},updateConnectionStatus(e,t=!1){const{statusDot:o,statusText:n,joinButton:i}=this.elements;e?(o&&(o.className="status-dot connected"),n&&(n.textContent="Connected"),i&&(t?(i.disabled=!1,i.innerHTML='<span>Join Chat</span><i class="fas fa-arrow-right"></i>'):(i.disabled=!0,i.textContent="Enter Data"))):(o&&(o.className="status-dot"),n&&(n.textContent="Connecting..."),i&&(i.disabled=!0,i.textContent="Connecting..."))},resetJoinButton(){const{joinButton:e}=this.elements;e&&(e.disabled=!1,e.innerHTML='<span>Join Chat</span><i class="fas fa-arrow-right"></i>')},setJoinButtonLoading(e="Joining..."){const{joinButton:t}=this.elements;t&&(t.disabled=!0,t.innerHTML=`<i class="fas fa-spinner fa-spin"></i> ${e}`)},showChatView(e){const{loginContainer:t,chatContainer:o,roomDisplay:n}=this.elements;n&&(n.textContent=this.sanitizeInput(e)),t&&(t.style.display='none'),o&&(o.style.display='flex')},showLoginView(){const{loginContainer:e,chatContainer:t,usernameInput:o,roomIdInput:n}=this.elements;e&&(e.style.display='flex'),t&&(t.style.display='none'),o&&(o.value=''),n&&(n.value='')},updateActiveUsers(e,t,o){const{activeUsers:n}=this.elements;if(!n)return;const i=t.length;let r;0===i?r="You are alone in the room":1===i?r=`Active: ${this.sanitizeInput(t[0])}`:i<=3?r=`Active: ${t.map(e=>this.sanitizeInput(e)).join(', ')}`:r=`${i} active users`,n.textContent=r},updateTypingIndicator(e){const{typingIndicator:t}=this.elements;if(!t)return;if(0===e.length)t.style.display='none',t.innerHTML='';else{let o;1===e.length?o=`${this.sanitizeInput(e[0])} is typing`:2===e.length?o=`${this.sanitizeInput(e[0])} and ${this.sanitizeInput(e[1])} are typing`:o=`${e.length} users are typing`,t.innerHTML=`${o}<span class="typing-dots"><span>.</span><span>.</span><span>.</span></span>`,t.style.display='flex'}},updateCharCount(e,t){const{charCount:o,sendButton:n,messageInput:i}=this.elements;if(o){o.textContent=`${e}/${t}`,o.style.color=e>t?"var(--error-color)":"var(--text-muted)"}if(n&&i){const r=e>0&&e<=t;n.disabled=!r}},updateSendButton(e,t=!1){const{sendButton:o}=this.elements;o&&(o.disabled=!(e||t))},setSendButtonLoading(e){const{sendButton:t}=this.elements;if(!t)return;e?(t.disabled=!0,t.innerHTML='<i class="fas fa-spinner fa-spin"></i>'):t.innerHTML='<i class="fas fa-paper-plane"></i>'},updateInputForImage(e){const{messageInput:t}=this.elements;t&&(t.placeholder=`Image selected: ${e}. Add caption or send.`,t.disabled=!0)},resetMessageInput(){const{messageInput:e,imageUpload:t}=this.elements;e&&(e.value='',e.placeholder='Type a message...',e.disabled=!1),t&&(t.value='')},setLoadingIndicator(e){const{loadingIndicator:t}=this.elements;t&&(e?t.classList.remove('hidden'):t.classList.add('hidden'))},validateInputs(e,t){const{usernameInput:o,roomIdInput:n}=this.elements;o&&(o.style.borderColor=e?"":"#dc3545"),n&&(n.style.borderColor=t?"":"#dc3545")},scrollToBottom(){const{messagesContainer:e}=this.elements;e&&(e.scrollTop=e.scrollHeight)},isScrolledToBottomOrNear(e=100){const{messagesContainer:t}=this.elements;return!t||t.scrollHeight-t.clientHeight<=t.scrollTop+e},showWelcomeMessage(){const e=document.querySelector('.welcome-message');e&&(e.style.display='block')},hideWelcomeMessage(){const e=document.querySelector('.welcome-message');e&&(e.style.display='none')},clearMessages(){const{messagesContainer:e,loadingIndicator:t}=this.elements;if(e){const o=e.querySelector('.welcome-message');e.innerHTML='',t&&e.appendChild(t),o&&e.appendChild(o)}this.showWelcomeMessage()},appendMessage(e){const{messagesContainer:t}=this.elements;t&&(this.hideWelcomeMessage(),t.appendChild(e))},prependMessage(e){const{messagesContainer:t,loadingIndicator:o}=this.elements;if(t){this.hideWelcomeMessage();const n=t.querySelector('.message');n?t.insertBefore(e,n):o?t.insertBefore(e,o.nextSibling):t.appendChild(e)}},getScrollHeight(){const{messagesContainer:e}=this.elements;return e?e.scrollHeight:0},setScrollTop(e){const{messagesContainer:t}=this.elements;t&&(t.scrollTop=e)},sanitizeInput(e){const t=document.createElement('div');return t.textContent=e,t.innerHTML},setViewportHeight(){const e=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${e}px`)}};if(typeof module!=="undefined")module.exports=UIManager;if(typeof window!=="undefined")window.UIManager=UIManager;
